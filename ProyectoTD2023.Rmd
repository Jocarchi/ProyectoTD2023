---
title: "ProyectoTD2023"
autor: "Andrés Chicaiza, María Castellanos, Hugo Lucas, Adrián Blat, Yuliana Villada"
output: html_document
date: "2023-04-18"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preguntas:

-   ¿Nos encontraremos con datos faltantes o nulos en la recogida de los datos?

Como podemos observar, en las gráficas mostradas para cada uno de los ficheros, nos encontramos con diversos datos faltantes, ya sea porque en algún momento de la recogida de datos se han perdido, porque se han cometido errores en la entrada de datos o por muchos factores más. Por ellos es importante considerar estos datos faltantes, a la hora de la interpretación de la información extraida.

-   ¿Hay algún patrón visible en la representación de los datos?

Una de las preguntas que surgen antes de la implementación del codigo para la lectura de los ficheros, es si la información de cada uno de estos estará relacionada, o si por el contrario no tendrán nada que ver. Una vez ya mostradas las gráficas y las tablas, es posible comprobar que sí hay ciertos aspectos en los que se verifica una relación en la información de los ficheros. Como podemos observar, la variable tiempo se va incrementando de forma lineal y las variables pdiastola y psistólica, tienen un valor igual a cero.

```{r}
library(ggplot2)
library(dplyr)

#Cabecera digital

cab_dig1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroDigital.dat"

cab_info_dig <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroDigital.dat")

max_cabdig1 <- cab_info_dig$size

cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)


#Fichero digital

fich_dig1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroDigital.dat"

fich_info <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroDigital.dat")

max_fichdig1 <- fich_info$size

fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)

lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)

nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")

dato_dig1 <- as.data.frame(lista)

colnames(dato_dig1) <- nombres

tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 2604)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)

dato_dig1
```

```{r}
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
```

```{r}
#Cabecera Analogica

cab_ana1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroAnalogico.dat"

cab_info_ana <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroAnalogico.dat")

max_cabana1 <- cab_info_ana$size

cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)

# Fichero Analogico

fich_ana1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size

fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000

tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)



```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
#Para la carpeta 0519

#Cabecera digital

# Se define la ubicación del archivo que contiene la cabecera digital.
cab_dig1 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroDigital.dat"

# Se obtiene información sobre la cabecera digital, como su tamaño y fecha 
#de creación.
cab_info_dig <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroDigital.dat")

# Se extrae el tamaño del archivo de la cabecera digital.
max_cabdig1 <- cab_info_dig$size

# Se lee el contenido del archivo de cabecera digital y se guarda 
#en un vector llamado "cabecera_dig1" utilizando la función "readBin()".
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)


#Fichero digital

# Se define la ubicación del archivo.
fich_dig1 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroDigital.dat"

# Se obtiene información sobre el archivo, como su tamaño y fecha de creación.
fich_info <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroDigital.dat")

# Se extrae el tamaño del archivo de registro digital.
max_fichdig1 <- fich_info$size

# Se lee el contenido del archivo y se guarda en un vector llamado "fichero_dig1" utilizando la función "readBin()".
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

# Se divide el vector "fichero_dig1" en vectores separados para cada 
#parámetro de interés.
HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

# Se calcula la media de la variable "
mediaVCP <- mean(VCP)

#Se crea una lista que contiene las variables 
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)

nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")

#Se crea un data frame a partir de la lista
dato_dig1 <- as.data.frame(lista)

colnames(dato_dig1) <- nombres

#Se Crea un vector llamado "tiempo" que va desde 0 hasta el número de 
#filas del data frame "dato_dig1" con un intervalo de 0.25.
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)

#Toma las primeras 19452 filas del vector "tiempo" y las asigna a la variable "tiempo".
tiempo <- head(tiempo, 19452)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)

dato_dig1
#Observamos en la tabla la información de diversas variables, las 
#cuales corresponden a la frecuencia cardiaca, (HR1 y HR2),medida por 
#latidos por minuto, la saturación en sangre de oxígenos(MspO2),medida en #porcentaje, la presión diástola y sistolica (Psist,Pdia),  la VCP se mide 
#en centímetros por segundo (cm/s) y el tiempo, el cual se mide en sgundos
```

```{r}
#Realizamos las gráficas 
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
```

```{r}
#Cabecera Analogica

# Se define la ubicación del archivo que contiene la cabecera analógica.
cab_ana1 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroAnalogico.dat"

#Se obtiene información sobre el archivo y se almacena en la variable cab_info_ana.
cab_info_ana <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroAnalogico.dat")

#Se obtiene el tamaño del archivo 
max_cabana1 <- cab_info_ana$size

#Se lee el archivo utilizando la función readBin() 
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)

# Fichero Analogico

# Se define la ubicación del archivo que contiene el fichero analógico analógica.
fich_ana2 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroAnalogico.dat"

#Se obtiene la información del archivo 
fich_info_ana <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroAnalogico.dat")

#Se obtiene el tamaño del archivo 
max_fichanal <- fich_info_ana$size

#Se lee el archivo con la funcion readBin
fichero_ana2 <- readBin(fich_ana2, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000

#Se genera un vector de tiempo con la secuencia de 0 a la longitud del archivo dividido por la frecuencia de muestreo y luego se divide en incrementos de 1/Frec.
tiempo_ana2 <- seq(from = 0, to = (length(fichero_ana2)-1)/Frec, by = 1/Frec)

#Se crea el data frame 
dato_ana2 <- data.frame(tiempo_ana2, fichero_ana2)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana2 <- cbind(h,min,seg)
```

```{r}
#Mostramos los gráficos
ggplot(dato_ana2, aes(tiempo_ana2,fichero_ana2)) + geom_line()
ggplot(dato_ana2, aes(tiempo_ana2,fichero_ana2)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
#Para la carpeta 0795xalvii8a7

#Cabecera digital
cab_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

#Fichero digital
fich_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroDigital.dat"
fich_info <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 2604)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)

```

```{r}
#Cabecera Analogica
cab_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)


# Fichero Analogico
fich_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
#Cabecera digital
cab_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

#Fichero digital
fich_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroDigital.dat"
fich_info <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 4372)


dato_dig1 <- dato_dig1  %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}

ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)

```

```{r}
#Cabecera Analogica
cab_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)

# Fichero Analogico
fich_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)
Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
# Para la carpeta ecg5_210xlxi81_IP_39_eBR_BRP_720 (Primera subcarpeta, 12.31.15)

# Cabecera digital
cab_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

# Fichero digital
fich_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroDigital.dat"
fich_info <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 3540)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
```

```{r}
# Cabecera Analógica
cab_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)


# Fichero Analógico
fich_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
# Para la carpeta ecg5_210xlxi81_IP_39_eBR_BRP_720 (Segunda subcarpeta, 12.49.57)

# Cabecera digital
cab_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

# Fichero digital
fich_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroDigital.dat"
fich_info <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 3540)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
```

```{r}
# Cabecera Analógica
cab_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)


# Fichero Analógico
fich_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```
