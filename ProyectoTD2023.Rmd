---
title: "ProyectoTD2023"
autor: Andrés Chicaiza, María Castellanos, Hugo Lucas, Adrián Blat, Yuliana Villada
date: "2023-04-18"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Preguntas:

-   ¿Nos encontraremos con datos faltantes o nulos en la recogida de los datos?

Como podemos observar, en las gráficas mostradas para cada uno de los ficheros, nos encontramos con diversos datos faltantes, ya sea porque en algún momento de la recogida de datos se han perdido, porque se han cometido errores en la entrada de datos o por muchos factores más. Por ellos es importante considerar estos datos faltantes, a la hora de la interpretación de la información extraida.

-   ¿Hay algún patrón visible en la representación de los datos?

Una de las preguntas que surgen antes de la implementación del codigo para la lectura de los ficheros, es si la información de cada uno de estos estará relacionada, o si por el contrario no tendrán nada que ver. Una vez ya mostradas las gráficas y las tablas, es posible comprobar que sí hay ciertos aspectos en los que se verifica una relación en la información de los ficheros. Como podemos observar, la variable tiempo se va incrementando de forma lineal y las variables pdiastola y psistólica, tienen un valor igual a cero.

-   ¿Existen diferencias notables en la gráfica entre diferentes momentos? ¿Qué factores podrían explicar esas diferencias?

Existen diferencias notables en las gráficas entre diferentes momentos debido a diferentes factores. Estos factores pueden incluir cambios en las variables medidas, como la frecuencia cardíaca, saturación de oxígeno o presión arterial, variabilidad natural de las variables y diferencias en el intervalo de tiempo, así como la frecuencia de muestreo. Estos elementos contribuyen a las variaciones en las gráficas y deben considerarse en el contexto clínico o experimental en el que se obtuvieron los datos.

-   ¿Qué información importante se puede extraer de la gráfica para poder tomar decisiones?

Primero de todo las tendencias y patrones, la gráfica revela tendencias o patrones a lo largo del tiempo como si hay un aumento constante en la frecuencia cardíaca o una disminución en la presión arterial, puede ser útiles para evaluar la progresión de una enfermedad o de un tratamiento.

Puntos destacados y anomalías, la gráfica puede revela puntos destacados, como picos o valles inusuales en los datos, indican eventos o anomalías importantes que requieren atención. Así como un pico repentino en la frecuencia cardíaca tanto de subida o de bajada.

Comparación entre diferentes variables, la gráfica permite comparar diferentes variables a la vez, es decir, simultaneamente. Analizamos la relación entre la frecuencia cardíaca y la presión arterial para evaluar la función cardiovascular, nos proporciona información valiosa sobre las interacciones entre diferentes sistemas fisiológicos y ayuda en la toma de decisiones clínicas.

- ¿Qué información adicional sería importante tener para poder hacer una interpretación más completa de los datos?

Para poder hacer una interpretación más completa de los datos, es importante tener información adicional como la fuente de la que se han obtenido los datos, la metodología utilizada para recopilar dichos datos, el tamaño de la muestra, su distribución, la presencia de valores atípicos(negativos, NA). Además, es importante conocer el contexto en el que se recopilaron los datos, es decir, si son válidos y fiables, y si existen factores externos que puedan afectar los resultados. 

Otros factores importantes a considerar son las variables que se midieron y cómo se midieron, las técnicas estadísticas utilizadas para analizar los datos, y el significado de los resultados obtenidos.

En resumen, para hacer una interpretación completa de los datos es necesario tener una comprensión profunda de la naturaleza de los datos y de los métodos utilizados para recopilarlos y analizarlos.

- ¿Qué información se puede obtener a partir de los gráficos generados?

Encontramos nueve tipos de gráficos distintos, en los cuales se muestran las evoluciones de las variables a lo largo del tiempo. El gráfico mostrado nos proporciona información sobre cómo cambian los valores de esa variable.

En dichos gráficos encontramos las variables HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica y Pmedia, todas ellas representadas a lo largo del avance de la variable tiempo.
```{r}
library(ggplot2)
library(dplyr)

#Cabecera digital

# Se define la ubicación del archivo que contiene la cabecera digital.
cab_dig1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroDigital.dat"

# Se obtiene información sobre la cabecera digital, como su tamaño y fecha de creación.
cab_info_dig <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroDigital.dat")

# Se extrae el tamaño del archivo de la cabecera digital.
max_cabdig1 <- cab_info_dig$size

# Se lee el contenido del archivo de cabecera digital y se guarda 
# en un vector llamado "cabecera_dig1" utilizando la función "readBin()".
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)


#Fichero digital

# Se define la ubicación del archivo.
fich_dig1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroDigital.dat"

# Se obtiene información sobre el archivo, como su tamaño y fecha de creación.
fich_info <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroDigital.dat")

# Se extrae el tamaño del archivo de registro digital.
max_fichdig1 <- fich_info$size

# Se lee el contenido del archivo y se guarda en un vector llamado 
# "fichero_dig1" utilizando la función "readBin()".
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

# Se divide el vector "fichero_dig1" en vectores separados para cada 
# parámetro de interés
HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

# Se calcula la media de la variable
mediaVCP <- mean(VCP)

#Se crea una lista que contiene las variables
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)

#Se crea vector con el nombre de las variables
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")

#Se crea un data frame a partir de la lista
dato_dig1 <- as.data.frame(lista)

#Se asigna el vector nombres a las columnas que incluye dato_dig1
colnames(dato_dig1) <- nombres

# Se Crea un vector llamado "tiempo" que va desde 0 hasta el número de 
# filas del data frame "dato_dig1" con un intervalo de 0.25.
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
# Toma las primeras 2604 filas del vector "tiempo" y las asigna a la variable "tiempo".
tiempo <- head(tiempo, 2604)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)

dato_dig1

# Observamos en la tabla la información de diversas variables, las cuales 
# corresponden a la frecuencia cardiaca, (HR1 y HR2),medida por latidos por minuto, 
# la saturación en sangre de oxígenos(MspO2),medida en #porcentaje, la presión diástola y 
# sistolica (Psist,Pdia),  la VCP se mide en centímetros por segundo (cm/s) y el tiempo, 
# el cual se mide en segundos
```

```{r}
# Realizamos las gráficas

ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
#El siguiente gráfico muestra la evolución de la variable "HR1" en función del tiempo. Podemos ver que la variable fluctúa alrededor de un valor medio, y que hay algunos picos y valles, que corresponden a los cambios de valor de la variable. La línea en sí misma muestra la tendencia general de la variable a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
#Este gráfico muestra la variación de la variable HR2 medida a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
#Este gráfico muestra la variación de la frecuencia cardíaca media (MHR) a lo largo del tiempo  El gráfico muestra un patrón de variación en la MHR a lo largo del tiempo, lo que puede ser de interés para el análisis de la función cardíaca y el seguimiento de la salud cardiovascular.

ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
#Este gráfico muestra la variación en el valor de la señal TOCO a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
#Este gráfico muestra la variación en el tiempo de los valores de MSpO2. La línea en el gráfico indica cómo cambia el valor de MSpO2 en función del tiempo.

ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
#El gráfico muestra la variación del valor de VCP en función del tiempo. Se puede observar que el valor de VCP, como vemos, el gráfico presenta diversas fluctuaciones en en varios momentos a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
#El gráfico muestra la presión sistólica en función del tiempo.

ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
#El gráfico muestra la variación de la presión diastólica a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
#El gráfico muestra la variación de la presión media durante un periodo de tiempo.
```

```{r}
#Cabecera Analogica

# Se define la ubicación del archivo que contiene la cabecera analógica.
cab_ana1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroAnalogico.dat"

# Se obtiene información sobre el archivo y se almacena en la variable cab_info_ana.
cab_info_ana <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/cabecera_FicheroAnalogico.dat")

# Se obtiene el tamaño del archivo 
max_cabana1 <- cab_info_ana$size

# Se lee el archivo utilizando la función readBin() 
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)

# Fichero Analogico

# Se define la ubicación del archivo que contiene el fichero analógico analógica.
fich_ana1 <- "data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroAnalogico.dat"

# Se obtiene la información del archivo 
fich_info_ana <- file.info("data/data/1059xlxveei79_ECGf2/27_09_2022/14.42.29_III_ECGyEXTyRESTO/ficheroAnalogico.dat")

# Se obtiene el tamaño del archivo
max_fichanal <- fich_info_ana$size

# Se lee el archivo con la funcion readBin
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

# Se le asigna un valor (1000) a Frec
Frec <- 1000

# Se genera un vector de tiempo con la secuencia de 0 a la longitud del archivo dividido por la frecuencia de muestreo y luego se divide en incrementos de 1/Frec.
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

#Se crea el data frame 
dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
# Mostramos los gráficos
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
# Para la carpeta 0519

# Cabecera digital

# Se define la ubicación del archivo que contiene la cabecera digital.
cab_dig1 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroDigital.dat"

# Se obtiene información sobre la cabecera digital, como su tamaño y fecha 
# de creación.
cab_info_dig <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroDigital.dat")

# Se extrae el tamaño del archivo de la cabecera digital.
max_cabdig1 <- cab_info_dig$size

# Se lee el contenido del archivo de cabecera digital y se guarda 
#en un vector llamado "cabecera_dig1" utilizando la función "readBin()".
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)


# Fichero digital

# Se define la ubicación del archivo.
fich_dig1 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroDigital.dat"

# Se obtiene información sobre el archivo, como su tamaño y fecha de creación.
fich_info <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroDigital.dat")

# Se extrae el tamaño del archivo de registro digital.
max_fichdig1 <- fich_info$size

# Se lee el contenido del archivo y se guarda en un vector llamado "fichero_dig1" utilizando la función "readBin()".
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

# Se divide el vector "fichero_dig1" en vectores separados para cada 
# parámetro de interés.
HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

# Se calcula la media de la variable "
mediaVCP <- mean(VCP)

# Se crea una lista que contiene las variables 
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)

nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")

# Se crea un data frame a partir de la lista
dato_dig1 <- as.data.frame(lista)

colnames(dato_dig1) <- nombres

# Se Crea un vector llamado "tiempo" que va desde 0 hasta el número de 
# filas del data frame "dato_dig1" con un intervalo de 0.25.
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)

# Toma las primeras 19452 filas del vector "tiempo" y las asigna a la variable "tiempo".
tiempo <- head(tiempo, 19452)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)

dato_dig1
# Observamos en la tabla la información de diversas variables, las 
# cuales corresponden a la frecuencia cardiaca, (HR1 y HR2),medida 
# por latidos por #minuto, la saturación en sangre de oxígenos(MspO2),
# medida en #porcentaje, la #presión diástola y sistolica (Psist,Pdia),
# la VCP se mide en centímetros por #segundo (cm/s) y el tiempo, el 
# cual se mide en segundos
```

```{r}
# Realizamos las gráficas 

ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
# El siguiente gráfico muestra la evolución de la variable "HR1" en 
# función del tiempo. Podemos ver que la variable fluctúa alrededor 
# de un valor medio, y que hay algunos picos y valles, que corresponden 
# a los cambios de valor de la variable. La línea en sí misma muestra 
# la tendencia general de la variable a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
# Este gráfico muestra la variación de la variable HR2 medida a lo largo 
# del tiempo. Como podemos observar la gráfica muestra un único valor a 
# medida que el tiempo avanza, el 0, por tanto el valor de la variable HR2,
# no evoluciona.

ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
# Este gráfico muestra la variación de la frecuencia cardíaca materna (MHR) 
# a lo largo del tiempo. El gráfico muestra un patrón de variación en la 
# MHR a lo largo del tiempo, lo que puede ser de interés para el análisis 
# de la función cardíaca y el seguimiento de la salud cardiovascular.

ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
# Este gráfico muestra la variación en el valor de la señal TOCO a lo 
# largo del tiempo. En el gráfico, se puede ver que la señal TOCO tiene 
# valores iguales a 0 durante gran parte del tiempo. Sin embargo, hay 
# algunos muchos picos en la señal,lo que indica una gran variacion de los datos.

ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
# Este gráfico muestra la variación en el tiempo de los valores de MSpO2. 
# La línea en el gráfico indica cómo cambia el valor de MSpO2 en función 
# del tiempo. En este caso, se puede observar que empiza con valor 0 durante 
# un breve periodo de tiempo, y rapidamente asciende a un valor muy cercano 
# a 100 y se estabiliza. 

ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
# El gráfico muestra la variación del valor de VCP en función del tiempo. 
# Se puede observar que el valor de VCP, como vemos, el gráfico presenta 
# diversas fluctuaciones en en varios momentos a lo largo del tiempo. 

ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
# El gráfico muestra la presión sistólica en función del tiempo. Se puede 
# observar que el valor de la presión sistólica varía a lo largo del tiempo, 
# comienza con valor 0, para luego llegar a valores que oscilan un valor 
# igual 120, acabando por mantenerse practicamente constante hasta el final 
# de la gráfica.

ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
# El gráfico muestra la variación de la presión diastólica a lo largo 
# del tiempo. La línea muestra que la presión diastólica empieza con 
# un valor igual a 0 y luego se mantiene en un rango bastante constante 
# de alrededor de 80 durante la mayor parte del tiempo, con algunas 
# fluctuaciones menores alrededor de ese rango.

ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
# El gráfico muestra la variación de la presión media durante un periodo 
# de tiempo. Como es posible observar, al igual que en los últimos 
# gráficos, empieza con valores igual a 0, hasta que incrementan 
# repentinamente, hasta estabilizarse n 80 con alguna pequeña bajada y subida.
```

```{r}
# Cabecera Analogica

# Se define la ubicación del archivo que contiene la cabecera analógica.
cab_ana1 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroAnalogico.dat"

# Se obtiene información sobre el archivo y se almacena en la variable cab_info_ana.
cab_info_ana <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/cabecera_FicheroAnalogico.dat")

# Se obtiene el tamaño del archivo 
max_cabana1 <- cab_info_ana$size

# Se lee el archivo utilizando la función readBin() 
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)

# Fichero Analogico

# Se define la ubicación del archivo que contiene el fichero analógico analógica.
fich_ana2 <- "data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroAnalogico.dat"

# Se obtiene la información del archivo 
fich_info_ana <- file.info("data/data/0519xxxiii14/06_02_2023/14.20.34/FicheroAnalogico.dat")

# Se obtiene el tamaño del archivo 
max_fichanal <- fich_info_ana$size

# Se lee el archivo con la funcion readBin
fichero_ana2 <- readBin(fich_ana2, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000

# Se genera un vector de tiempo con la secuencia de 0 a la longitud del 
# archivo dividido por la frecuencia de muestreo y luego se divide en incrementos de 1/Frec.
tiempo_ana2 <- seq(from = 0, to = (length(fichero_ana2)-1)/Frec, by = 1/Frec)

# Se crea el data frame 
dato_ana2 <- data.frame(tiempo_ana2, fichero_ana2)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana2 <- cbind(h,min,seg)
```

```{r}
# Mostramos los gráficos
ggplot(dato_ana2, aes(tiempo_ana2,fichero_ana2)) + geom_line()
ggplot(dato_ana2, aes(tiempo_ana2,fichero_ana2)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
# Para la carpeta 0795xalvii8a7

# Cabecera digital

# Se define la ubicación del archivo que contiene la cabecera digital.
cab_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroDigital.dat"

# Obtenemos información sobre la cabecera digital, así como su tamaño y la fecha
# de creación
cab_info_dig <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroDigital.dat")

# Tamaño del archivo
max_cabdig1 <- cab_info_dig$size

# Se lee el contenido del archivo de cabecera digital y se guarda 
#en un vector llamado "cabecera_dig1" utilizando la función "readBin()".
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)


# Fichero digital
# Se define la ubicación del archivo.
fich_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroDigital.dat"

# Se obtiene información sobre el archivo
fich_info <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroDigital.dat")

# Se extrae el tamaño del archivo de registro digital.
max_fichdig1 <- fich_info$size

# Se lee el contenido del archivo y se guarda en un vector llamado "fichero_dig1" utilizando la función "readBin()".
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

# Se divide el vector "fichero_dig1" en vectores separados para cada 
#parámetro de interés.
HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

# Se calcula la media de la variable 
mediaVCP <- mean(VCP)

# Se crea una lista que contiene las variables 
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")

# Se crea un data frame a partir de la lista
dato_dig1 <- as.data.frame(lista)
# Se asigna el vector nombres a las columnas que incluye dato_dig1
colnames(dato_dig1) <- nombres
# Se Crea un vector llamado "tiempo" que va desde 0 hasta el número de 
# filas del data frame "dato_dig1" con un intervalo de 0.25.
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
# Toma las primeras 2604 filas del vector "tiempo" y las asigna a la variable "tiempo".
tiempo <- head(tiempo, 2604)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
# Observamos en la tabla la información de diversas variables, las cuales corresponden a la frecuencia 
# cardiaca, (HR1 y HR2),medida por latidos por minuto, la saturación en sangre de oxígenos(MspO2), 
# medida en porcentaje, la presión diástola y sistolica (Psist,Pdia),  la VCP se mide en centímetros 
# por segundo (cm/s) y el tiempo, el cual se mide en segundos
```

```{r}
# Realizamos las gráficas

ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
# El siguiente gráfico muestra la evolución de la variable "HR1" en función del tiempo. Podemos ver que la 
# variable fluctúa alrededor de un valor medio, y que hay algunos picos y valles, que corresponden a los
# cambios de valor de la variable. La línea en sí misma muestra la tendencia general de la variable a lo 
# largo del tiempo.

ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
# Este gráfico muestra la variación de la variable HR2 medida a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
# Este gráfico muestra la variación de la frecuencia cardíaca media (MHR) a lo largo del tiempo.
# El gráfico muestra un patrón de variación en la MHR a lo largo del tiempo, lo que puede ser de 
# interés para el análisis de la función cardíaca y el seguimiento de la salud cardiovascular.

ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
# Este gráfico muestra la variación en el valor de la señal TOCO a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
# Este gráfico muestra la variación en el tiempo de los valores de MSpO2. La línea en el gráfico 
# indica cómo cambia el valor de MSpO2 en función del tiempo.

ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
# El gráfico muestra la variación del valor de VCP en función del tiempo. Se puede observar que el valor 
# de VCP, como vemos, el gráfico presenta diversas fluctuaciones en en varios momentos a lo largo del 
# tiempo.

ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
# El gráfico muestra la presión sistólica en función del tiempo. Se puede observar que el valor de la 
# presión sistólica varía a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
# El gráfico muestra la variación de la presión diastólica a lo largo del tiempo.

ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
# El gráfico muestra la variación de la presión media durante un periodo de tiempo.
```

```{r}
#Cabecera Analogica
# Se define la ubicación del archivo que contiene la cabecera analógica.
cab_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroAnalogico.dat"

#Se obtiene información sobre el archivo y se almacena en la variable cab_info_ana.
cab_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/cabecera_FicheroAnalogico.dat")

#Se obtiene el tamaño de la variable 
max_cabana1 <- cab_info_ana$size

#Se lee la informacion del primer archivo 
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)

#Se lee la informacion del segundo archivo 
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)


# Fichero Analogico
#Se especifica la ruta 
fich_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroAnalogico.dat"

#Se obtiene la información del archivo 
fich_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.00/ficheroAnalogico.dat")

#Se obtiene el tamaño de la variable
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
#Cabecera digital
cab_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

#Fichero digital
fich_dig1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroDigital.dat"
fich_info <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 4372)


dato_dig1 <- dato_dig1  %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}

ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)

```

```{r}
#Cabecera Analogica
cab_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)

# Fichero Analogico
fich_ana1 <- "data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/0795xalvii8a7/27_09_2022/10.11.12/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)
Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
# Para la carpeta ecg5_210xlxi81_IP_39_eBR_BRP_720 (Primera subcarpeta, 12.31.15)

# Cabecera digital
cab_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

# Fichero digital
fich_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroDigital.dat"
fich_info <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 3540)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
```

```{r}
# Cabecera Analógica
cab_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)


# Fichero Analógico
fich_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.31.15/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```

```{r}
# Para la carpeta ecg5_210xlxi81_IP_39_eBR_BRP_720 (Segunda subcarpeta, 12.49.57)

# Cabecera digital
cab_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroDigital.dat"
cab_info_dig <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroDigital.dat")
max_cabdig1 <- cab_info_dig$size
cabecera_dig1 <- readBin(cab_dig1,integer(),n = max_cabdig1,size = 1, signed = F)

# Fichero digital
fich_dig1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroDigital.dat"
fich_info <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroDigital.dat")
max_fichdig1 <- fich_info$size
fichero_dig1 <- readBin(fich_dig1,integer(),n = max_fichdig1,size = 1, signed = F)

HR1 <- fichero_dig1[seq(from=1, to = length(fichero_dig1), by = 9)]
HR2 <- fichero_dig1[seq(from=2, to = length(fichero_dig1), by = 9)]
MHR <- fichero_dig1[seq(from=3, to = length(fichero_dig1), by = 9)]
TOCO <- fichero_dig1[seq(from=4, to = length(fichero_dig1), by = 9)]
MSpO2 <- fichero_dig1[seq(from=5, to = length(fichero_dig1), by = 9)]
VCP <- fichero_dig1[seq(from=6, to = length(fichero_dig1), by = 9)]
Psistolica <- fichero_dig1[seq(from=7, to = length(fichero_dig1), by = 9)]
Pdiastolica <- fichero_dig1[seq(from=8, to = length(fichero_dig1), by = 9)]
Pmedia <- fichero_dig1[seq(from=9, to = length(fichero_dig1), by = 9)]

mediaVCP <- mean(VCP)
lista <- list(HR1, HR2, MHR, TOCO, MSpO2, VCP, Psistolica, Pdiastolica, Pmedia)
nombres <- c("HR1", "HR2", "MHR", "TOCO", "MSpO2", "VCP", "Psistolica", "Pdiastolica", "Pmedia")
dato_dig1 <- as.data.frame(lista)
colnames(dato_dig1) <- nombres
tiempo <- seq(0, length.out = nrow(dato_dig1), by = 0.25)
tiempo <- head(tiempo, 3540)


dato_dig1 <- dato_dig1 %>%
    mutate(tiempo = tiempo)

hora <- ((((length(dato_dig1) / 9) / 4) / 60) / 60)
min <- ((hora - floor(hora)) * 60)
seg <- ((min - floor(min))) * 60
  
tiempo_digital <- cbind(hora, min, seg)
dato_dig1
```

```{r}
ggplot(dato_dig1, aes(tiempo,HR1)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,HR2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MHR)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,TOCO)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,MSpO2)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,VCP)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Psistolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pdiastolica)) + geom_line(size=0.2)
ggplot(dato_dig1, aes(tiempo,Pmedia)) + geom_line(size=0.2)
```

```{r}
# Cabecera Analógica
cab_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroAnalogico.dat"
cab_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/cabecera_FicheroAnalogico.dat")
max_cabana1 <- cab_info_ana$size
cabecera_ana1.1 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 1, signed = F)
cabecera_ana1.2 <- readBin(cab_dig1,integer(),n = max_cabana1,size = 2, signed = T)


# Fichero Analógico
fich_ana1 <- "data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroAnalogico.dat"
fich_info_ana <- file.info("data/data/ecg5_210xlxi81_IP_39_eBR_BRP_720/12.49.57/ficheroAnalogico.dat")
max_fichanal <- fich_info_ana$size
fichero_ana1 <- readBin(fich_ana1, integer(), n = max_fichanal, size = 2, signed = T)

Frec <- 1000
tiempo_ana1 <- seq(from = 0, to = (length(fichero_ana1)-1)/Frec, by = 1/Frec)

dato_ana1 <- data.frame(tiempo_ana1, fichero_ana1)

h <- ((length(dato_ana1)/Frec)/60)/60
min <- ((h - floor(h)) * 60)
seg <- ((min - floor(min)) * 60)

time_ana1 <- cbind(h,min,seg)
```

```{r}
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line()
ggplot(dato_ana1, aes(tiempo_ana1,fichero_ana1)) + geom_line(size = 1) + lims(x = c(692,700.03), y = c(-198,957))
```
